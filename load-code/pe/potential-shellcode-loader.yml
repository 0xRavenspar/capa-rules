rule:
  meta:
    name: potential shellcode loader
    namespace: load-code/shellcode
    author: "john.gorman@fireeye.com"
    scope: function
    att&ck:
      - Defense Evasion::Obfuscated Files or Information [T1027]
    references:
      - https://github.com/EgeBalci/amber
    examples:
      - bb7922d368a9a9c8d981837b5ad988f1
  features:
    - or:
      - and:
        - api: kernel32.LoadLibraryA
        - api: kernel32.GetProcAddress
        - api: kernel32.GetModuleHandleA
        - api: kernel32.VirtualAlloc