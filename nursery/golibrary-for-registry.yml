rule:
  meta:
    name: use Go library for registry
    namespace: host-interaction/registry
    description: Uses a Go library for interacting with the Windows registry.
    author:
      - joakim@intezer.com
    scope: file
    references:
      - https://github.com/golang/sys
  features:
    - and:
      - match: compiled with Go
      - or:
        - string: golang.org/x/sys/windows/registry.Key.Close
        - string: github.com/golang/sys/windows/registry.Key.Close
